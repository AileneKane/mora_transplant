allabamse<-c(abamgermseorg)
allabam<-c(abammngermorg)
x<-c(1,2,3,4,5,1,2,3,4,5,1,2,3,4,5)
for (i in 1:length(allabam)){
arrows(x[i],allabam[i]-allabamse[i],x[i],allabam[i]+allabamse[i],length=.05,angle=90,code=0)}
lines(abammngermorg[,1]~X,lty=2)
points(abammngermorg[,1]~X,pch=21,cex=1.8,bg="dark gray")
lines(abammngermorg[,2]~X,lty=1)
points(abammngermorg[,2]~X,pch=21,cex=1.8,bg="white")
axis(1, at = c(1,2,3,4,5), labels = c( "(668)","(704)","(1064)","(1603)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
mtext("Proportion Seeds Germinating", side=2, line=3)
##TSHE
tsheplot=plot(tshemngermorg[,1]~X[3:5],ylab="",xlab="",xlim=c(1,5),col.axis="white",ylim=c(0,.05),type="p",bty="l",pch=21,cex=1.8,las=1,bg="black", cex.main=1.3)#ylim=c(0,.05) for inconsistent y axes
polygon(c(2,2,4,4),c(0,.06,.06,0),col="light gray", border="light gray")#for inconsistent y axes
axis(2,at=c(0,.01,.02,.03,.04,.05),las=1, cex.axis=1.3)#for inconsistent y axes
#polygon(c(2,2,4,4),c(0,.5,.5,0),col="light gray", border="light gray")
#axis(2,at=c(0,.1,.2,.3,.4),las=1, cex.axis=1.3)
mtext("Tsuga heterophylla",side=3,line=1, adj=0, font=3)
mtext("c",side=3,line=1, adj=-.1)
alltshese<-c(tshegermseorg)
alltshe<-c(tshemngermorg)
x<-c(3,4,5,3,4,5)
for (i in 1:length(alltshe)){
arrows(x[i],alltshe[i]-alltshese[i],x[i],alltshe[i]+alltshese[i],length=.05,angle=90,code=0)}
lines(tshemngermorg[,1]~X[3:5],lty=2)
points(tshemngermorg[,1]~X[3:5],pch=21,cex=1.8,bg="dark gray")
lines(tshemngermorg[,2]~X[3:5],lty=1)
points(tshemngermorg[,2]~X[3:5],pch=21,cex=1.8,bg="white")
axis(1, at = c(1,2,3,4,5), labels = c( "", "","(668)", "(704)","(1064)"), tick = FALSE, cex.axis=1.1, line=-.5)
axis(1, at = c(1,2,3,4,5), labels = c( "Below","Lower","Mid", "Upper", "Above"), tick = FALSE, cex.axis=1.1, line=0.5)
mtext ("Location in range (m)", line=-13, cex=.9)
#Survival
#TSME
plot(tsmemnsorg2[,1]~X,ylab="",xlab="",xlim=c(1,5),col.axis="white",ylim=c(0,.5),type="p",bty="l",pch=21,cex=1.8,las=1,bg="black", cex.main=1.3)
polygon(c(2,2,4,4),c(0,.6,.6,0),col="light gray", border="light gray")
axis(2,at=c(0,.1,.2,.3,.4,.5),las=1, cex.axis=1.3)
mtext("Tsuga mertensiana",side=3,line=2, adj=0, font=3)
mtext("d",side=3,line=2, adj=-.1)
alltsmese<-c(tsmesesorg2)
alltsme<-c(tsmemnsorg2)
x<-c(1,2,3,4,5,1,2,3,4,5,1,2,3,4,5)
for (i in 1:length(alltsme)){
arrows(x[i],alltsme[i]-alltsmese[i],x[i],alltsme[i]+alltsmese[i],length=.05,angle=90,code=0)}
lines(tsmemnsorg2[,1]~X,lty=3)
points(tsmemnsorg2[,1]~X,pch=21,cex=1.8,bg="black")
lines(tsmemnsorg2[,2]~X,lty=2)
points(tsmemnsorg2[,2]~X,pch=21,cex=1.8,bg="dark gray")
lines(tsmemnsorg2[,3]~X,lty=1)
points(tsmemnsorg2[,3]~X,pch=21,cex=1.8,bg="white")
#legend(1,.8,legend=c("Lower limit","Mid-range", "Upper limit"),bty="n",pch=21,pt.bg=c("black","dark gray","white"),angle=45,cex=1.1,lty=c(3,2,1), pt.cex=1.5)
axis(1, at = c(1,2,3,4,5), labels = c( "(1064)", "(1197)","(1460)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
##ABAM
plot(abammnsorg2[,1]~X,ylab="",xlab="",xlim=c(1,5),col.axis="white",ylim=c(0,.5),type="p",bty="l",pch=21,cex=1.8,las=1,bg="black", cex.main=1.3)
polygon(c(2,2,4,4),c(0,.6,.6,0),col="light gray", border="light gray")
axis(2,at=c(0,.1,.2,.3,.4,.5),las=1, cex.axis=1.3)
mtext("Abies amabilis",side=3,line=1, adj=0, font=3)
mtext("e",side=3,line=1, adj=-.1)
allabamse<-c(abamsesorg2)
allabam<-c(abammnsorg2)
x<-c(1,2,3,4,5,1,2,3,4,5,1,2,3,4,5)
for (i in 1:length(allabam)){
arrows(x[i],allabam[i]-allabamse[i],x[i],allabam[i]+allabamse[i],length=.05,angle=90,code=0)}
lines(abammnsorg2[,1]~X,lty=3)
points(abammnsorg2[,1]~X,pch=21,cex=1.8,bg="black")
lines(abammnsorg2[,2]~X,lty=2)
points(abammnsorg2[,2]~X,pch=21,cex=1.8,bg="dark gray")
lines(abammnsorg2[,3]~X,lty=2)
points(abammnsorg2[,3]~X,pch=21,cex=1.8,bg="dark gray")
lines(abammnsorg2[,4]~X,lty=1)
points(abammnsorg2[,4]~X,pch=21,cex=1.8,bg="white")
axis(1, at = c(1,2,3,4,5), labels = c( "(668)","(704)","(1064)","(1603)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
mtext("Proportion Surviving Seedlings", side=2, line=3)
##TSHE
tsheplot=plot(tshemnsorg2[,1]~X[3:5],ylab="",xlab="",xlim=c(1,5),col.axis="white",ylim=c(0,.5),type="p",bty="l",pch=21,cex=1.8,las=1,bg="black", cex.main=1.3)
polygon(c(2,2,4,4),c(0,.6,.6,0),col="light gray", border="light gray")
axis(2,at=c(0,.1,.2,.3,.4,.5),las=1, cex.axis=1.3)
mtext("Tsuga heterophylla",side=3,line=1, adj=0, font=3)
mtext("f",side=3,line=1, adj=-.1)
alltshese<-c(tshesesorg2)
alltshe<-c(tshemnsorg2)
x<-c(3,4,5,3,4,5)
for (i in 1:length(alltshe)){
arrows(x[i],alltshe[i]-alltshese[i],x[i],alltshe[i]+alltshese[i],length=.05,angle=90,code=0)}
lines(tshemnsorg2[,1]~X[3:5],lty=2)
points(tshemnsorg2[,1]~X[3:5],pch=21,cex=1.8,bg="dark gray")
lines(tshemnsorg2[,2]~X[3:5],lty=1)
points(tshemnsorg2[,2]~X[3:5],pch=21,cex=1.8,bg="white")
axis(1, at = c(1,2,3,4,5), labels = c( "", "","(668)", "(704)","(1064)"), tick = FALSE, cex.axis=1.1, line=-.5)
axis(1, at = c(1,2,3,4,5), labels = c( "Below","Lower","Mid", "Upper", "Above"), tick = FALSE, cex.axis=1.1, line=0.5)
mtext ("Location in range (m)", line=-13, cex=.9)
####Height Increment
plot(tsmehi[,1]~X,ylab="",xlab="",xlim=c(1,5),col.axis="white",ylim=c(0,1),type="p",bty="l",pch=21,cex=1.8,las=1,bg="black", cex.main=1.3)
polygon(c(2,2,4,4),c(0,1,1,0),col="light gray", border="light gray")
axis(2,at=c(0,.2,.4,.6,.8,1),las=1, cex.axis=1.3)
mtext("Tsuga mertensiana",side=3,line=2, adj=0, font=3)
mtext("g",side=3,line=2, adj=-.1)
alltsmese<-c(tsmesehiorg)
alltsme<-c(tsmehi)
x<-c(1,2,3,4,5,1,2,3,4,5,1,2,3,4,5)
for (i in 1:length(alltsme)){
arrows(x[i],alltsme[i]-alltsmese[i],x[i],alltsme[i]+alltsmese[i],length=.05,angle=90,code=0)}
lines(tsmehi[,1]~X,lty=3)
points(tsmehi[,1]~X,pch=21,cex=1.8,bg="black")
lines(tsmehi[,2]~X,lty=2)
points(tsmehi[,2]~X,pch=21,cex=1.8,bg="dark gray")
lines(tsmehi[,3]~X,lty=1)
points(tsmehi[,3]~X,pch=21,cex=1.8,bg="white")
axis(1, at = c(1,2,3,4,5), labels = c( "(1064)", "(1197)","(1460)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
#mtext("Seed source",at=2,cex=.8, line=.5)
##ABAM
plot(abamhi[,1]~X,ylab="",xlab="",xlim=c(1,5),col.axis="white",ylim=c(-1,1),type="p",bty="l",pch=21,cex=1.8,las=1,bg="black", cex.main=1.3)
polygon(c(2,2,4,4),c(-1,1,1,-1),col="light gray", border="light gray")
axis(2,las=1, cex.axis=1.3)
mtext("Abies amabilis",side=3,line=1, adj=0, font=3)
mtext("h",side=3,line=1, adj=-.1)
allabamse<-c(abamsehiorg)
allabam<-c(abamhi)
x<-c(1,2,3,4,5,1,2,3,4,5,1,2,3,4,5)
for (i in 1:length(allabam)){
arrows(x[i],allabam[i]-allabamse[i],x[i],allabam[i]+allabamse[i],length=.05,angle=90,code=0)}
lines(abamhi[,1]~X,lty=3)
points(abamhi[,1]~X,pch=21,cex=1.8,bg="black")
lines(abamhi[,2]~X,lty=2)
points(abamhi[,2]~X,pch=21,cex=1.8,bg="dark gray")
lines(abamhi[,3]~X,lty=2)
points(abamhi[,3]~X,pch=21,cex=1.8,bg="dark gray")
lines(abamhi[,4]~X,lty=1)
points(abamhi[,4]~X,pch=21,cex=1.8,bg="white")
axis(1, at = c(1,2,3,4,5), labels = c( "(668)","(704)","(1064)","(1603)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
mtext("Annual height increment (cm)", side=2, line=3)
##TSHE
plot(tshehi[,1]~X[3:5],ylab="",xlab="",xlim=c(1,5),col.axis="white",ylim=c(0,1),type="p",bty="l",pch=21,cex=1.8,las=1,bg="black", cex.main=1.3)
polygon(c(2,2,4,4),c(0,1,1,0),col="light gray", border="light gray")
axis(2,at=c(0,.2,.4,.6,.8,1),las=1, cex.axis=1.3)
mtext("Tsuga heterophylla",side=3,line=1, adj=0, font=3)
mtext("i",side=3,line=1, adj=-.1)
alltshese<-c(tshesehiorg)
alltshe<-c(tshehi)
x<-c(3,4,5,3,4,5)
for (i in 1:length(alltshe)){
arrows(x[i],alltshe[i]-alltshese[i],x[i],alltshe[i]+alltshese[i],length=.05,angle=90,code=0)}
lines(tshehi[,1]~X[3:5],lty=2)
points(tshehi[,1]~X[3:5],pch=21,cex=1.8,bg="dark gray")
lines(tshehi[,2]~X[3:5],lty=1)
points(tshehi[,2]~X[3:5],pch=21,cex=1.8,bg="white")
axis(1, at = c(1,2,3,4,5), labels = c( "", "","(668)", "(704)","(1064)"), tick = FALSE, cex.axis=1.1, line=-.5)
axis(1, at = c(1,2,3,4,5), labels = c( "Below","Lower","Mid", "Upper", "Above"), tick = FALSE, cex.axis=1.1, line=0.5)
mtext ("Location in range (m)", line=-13, cex=.9)
#Feb 21, 2015
#plot, with change in effects of comp vs no comp
compsurvmod.tsme=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=tsmedat)
summary(compsurvmod.tsme)#LL: -2813.5 (Null LL:-2864.7)
compsurvmod.abam=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=abamdat)
summary(compsurvmod.abam)#LL: -2616.3 (Null LL:-2765.6)
compsurvmod.tshe=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=tshedat)
summary(compsurvmod.tshe)#LL: -1422.8 (Null LL:-1546.4)
himod.abam<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=abamdat)#
summary(himod.abam)
himod.tsme<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=tsmedat)
summary(himod.tsme)
himod.tshe<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=tshedat)#
summary(himod.tshe)
#get coefs and their ses
tsmesurvcan=c(coef(compsurvmod.tsme)[6],coef(compsurvmod.tsme)[6]+coef(compsurvmod.tsme)[8:11])
tsmesurvund=c(coef(compsurvmod.tsme)[7],coef(compsurvmod.tsme)[7]+coef(compsurvmod.tsme)[12:15])
tsmesurvcan.se=c(summary(compsurvmod.tsme)$table[6,2],summary(compsurvmod.tsme)$table[8:11,2])
tsmesurvund.se=c(summary(compsurvmod.tsme)$table[7,2],summary(compsurvmod.tsme)$table[12:15,2])
abamsurvcan=c(coef(compsurvmod.abam)[6],coef(compsurvmod.abam)[6]+coef(compsurvmod.abam)[8:11])
abamsurvund=c(coef(compsurvmod.abam)[7],coef(compsurvmod.abam)[7]+coef(compsurvmod.abam)[12:15])
abamsurvcan.se=c(summary(compsurvmod.abam)$table[6,2],summary(compsurvmod.abam)$table[8:11,2])
abamsurvund.se=c(summary(compsurvmod.abam)$table[7,2],summary(compsurvmod.abam)$table[12:15,2])
tshesurvcan=c(coef(compsurvmod.tshe)[4],coef(compsurvmod.tshe)[4]+coef(compsurvmod.tshe)[6:7])
tshesurvund=c(coef(compsurvmod.tshe)[5],coef(compsurvmod.tshe)[5]+coef(compsurvmod.tshe)[8:9])
tshesurvcan.se=c(summary(compsurvmod.tshe)$table[4,2],summary(compsurvmod.tshe)$table[6:7,2])
tshesurvund.se=c(summary(compsurvmod.tshe)$table[4,2],summary(compsurvmod.tshe)$table[8:9,2])
#HI
tsmehican=c(fixef(himod.tsme)[6],fixef(himod.tsme)[6]+fixef(himod.tsme)[8:11])
tsmehiund=c(fixef(himod.tsme)[7],fixef(himod.tsme)[7]+fixef(himod.tsme)[12:15])
tsmehican.se=c(summary(himod.tsme)$coef[6,2],summary(himod.tsme)$coef[8:11,2])
tsmehiund.se=c(summary(himod.tsme)$coef[7,2],summary(himod.tsme)$coef[12:15,2])
abamhican=c(fixef(himod.abam)[6],fixef(himod.abam)[6]+fixef(himod.abam)[8:11])
abamhiund=c(fixef(himod.abam)[7],fixef(himod.abam)[7]+fixef(himod.abam)[12:15])
abamhican.se=c(summary(himod.abam)$coef[6,2],summary(himod.abam)$coef[8:11,2])
abamhiund.se=c(summary(himod.abam)$coef[7,2],summary(himod.abam)$coef[12:15,2])
tshehican=c(fixef(himod.tshe)[4],fixef(himod.tshe)[4]+fixef(himod.tshe)[6:7])
tshehiund=c(fixef(himod.tshe)[5],fixef(himod.tshe)[5]+fixef(himod.tshe)[8:9])
tshehican.se=c(summary(himod.tshe)$coef[4,2],summary(himod.tshe)$coef[6:7,2])
tshehiund.se=c(summary(himod.tshe)$coef[4,2],summary(himod.tshe)$coef[8:9,2])
###Barplot
quartz(height=7,width=7)
par(mfcol=c(3,2),mai=c(.6,.8,.2,.1), omi=c(.7,.01,.2,.2))
plottsme<-barplot(as.matrix(rbind(tsmesurvund,tsmesurvcan)),width=.9,ylab="",xlab="",names.arg=c("","","","",""),ylim=c(-1,1),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3,xaxt='n', yaxt='n')
mtext("Tsuga mertensiana",side=3,line=1, adj=0, font=3)
mtext("a",side=3,line=1, adj=-.1)
polygon(c(3.5,3.5,11,11),c(-1,1,1,-1),col="light gray", border="light gray")
par(new=T)
plottsme<-barplot(as.matrix(rbind(tsmesurvund,tsmesurvcan)),width=.9,ylab="",xlab="",names.arg=c("","","","",""),ylim=c(-1,1),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
abline(h=0)
x<-c(plottsme)
alltsme.lcl=rbind(tsmesurvund-tsmesurvund.se,tsmesurvcan-tsmesurvcan.se)
alltsme.ucl=rbind(tsmesurvund+tsmesurvund.se,tsmesurvcan+tsmesurvcan.se)
#add error bars
for (i in 1:length(alltsme.lcl)){
arrows(x[i],alltsme.lcl[i],x[i],alltsme.ucl[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "(1064)", "(1197)","(1460)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
##ABAM
plotabam<-barplot(as.matrix(rbind(abamsurvund,abamsurvcan)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.5,1.5),las=1,col=c("palegreen1","darkgreen"),xaxt='n', yaxt='n',beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
polygon(c(3.5,3.5,11,11),c(-1.5,1.5,1.5,-1.5),col="light gray", border="light gray")
par(new=T)
plotabam<-barplot(as.matrix(rbind(abamsurvund,abamsurvcan)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.5,1.5),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
mtext("Abies amabilis",side=3,line=1, adj=0, font=3)
mtext("b",side=3,line=1, adj=-.1)
abline(h=0)
mtext("Effect of neighbors on survival time", side=2, line=4.3)
mtext("(Proportion, relative to no neighbors)", side=2, line=3, cex=.9)
x<-c(plotabam)
allabam.lcl=rbind(abamsurvund-abamsurvund.se,abamsurvcan-abamsurvcan.se)
allabam.ucl=rbind(abamsurvund+abamsurvund.se,abamsurvcan+abamsurvcan.se)
#add error bars
for (i in 1:length(allabam.lcl)){
arrows(x[i],allabam.lcl[i],x[i],allabam.ucl[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "(668)", "(704)","(1064)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
##TSHE
tshesurvund2=c(NA,NA,tshesurvund)
tshesurvcan2=c(NA,NA,tshesurvcan)
plottshe<-barplot(as.matrix(rbind(tshesurvund2,tshesurvcan2)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),xaxt='n', yaxt='n',ylim=c(-1.5,.5),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
polygon(c(3.5,3.5,11,11),c(-1.5,.5,.5,-1.5),col="light gray", border="light gray")
mtext("Tsuga heterophylla",side=3,line=1, adj=0, font=3)
mtext("c",side=3,line=1, adj=-.1)
abline(h=0)
par(new=T)
plottshe<-barplot(as.matrix(rbind(tshesurvund2,tshesurvcan2)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.5,.5),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
abline(h=0)
x<-c(plottshe)
tshesurvund.se2=c(0,0,tshesurvund.se)
tshesurvcan.se2=c(0,0,tshesurvcan.se)
alltshe.lcl2=rbind(tshesurvund2-tshesurvund.se2,tshesurvcan2-tshesurvcan.se2)
alltshe.ucl2=rbind(tshesurvund2+tshesurvund.se2,tshesurvcan2+tshesurvcan.se2)
#add error bars
compsurvmod.tsme=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=tsmedat)
summary(compsurvmod.tsme)#LL: -2813.5 (Null LL:-2864.7)
compsurvmod.abam=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=abamdat)
summary(compsurvmod.abam)#LL: -2616.3 (Null LL:-2765.6)
compsurvmod.tshe=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=tshedat)
summary(compsurvmod.tshe)#LL: -1422.8 (Null LL:-1546.4)
himod.abam<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=abamdat)#
summary(himod.abam)
himod.tsme<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=tsmedat)
summary(himod.tsme)
himod.tshe<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=tshedat)#
summary(himod.tshe)
#
tsmesurvcan=c(coef(compsurvmod.tsme)[6],coef(compsurvmod.tsme)[6]+coef(compsurvmod.tsme)[8:11])
tsmesurvund=c(coef(compsurvmod.tsme)[7],coef(compsurvmod.tsme)[7]+coef(compsurvmod.tsme)[12:15])
tsmesurvcan.se=c(summary(compsurvmod.tsme)$table[6,2],summary(compsurvmod.tsme)$table[8:11,2])
tsmesurvund.se=c(summary(compsurvmod.tsme)$table[7,2],summary(compsurvmod.tsme)$table[12:15,2])
abamsurvcan=c(coef(compsurvmod.abam)[6],coef(compsurvmod.abam)[6]+coef(compsurvmod.abam)[8:11])
abamsurvund=c(coef(compsurvmod.abam)[7],coef(compsurvmod.abam)[7]+coef(compsurvmod.abam)[12:15])
abamsurvcan.se=c(summary(compsurvmod.abam)$table[6,2],summary(compsurvmod.abam)$table[8:11,2])
abamsurvund.se=c(summary(compsurvmod.abam)$table[7,2],summary(compsurvmod.abam)$table[12:15,2])
tshesurvcan=c(coef(compsurvmod.tshe)[4],coef(compsurvmod.tshe)[4]+coef(compsurvmod.tshe)[6:7])
tshesurvund=c(coef(compsurvmod.tshe)[5],coef(compsurvmod.tshe)[5]+coef(compsurvmod.tshe)[8:9])
tshesurvcan.se=c(summary(compsurvmod.tshe)$table[4,2],summary(compsurvmod.tshe)$table[6:7,2])
tshesurvund.se=c(summary(compsurvmod.tshe)$table[4,2],summary(compsurvmod.tshe)$table[8:9,2])
#HI
tsmehican=c(fixef(himod.tsme)[6],fixef(himod.tsme)[6]+fixef(himod.tsme)[8:11])
tsmehiund=c(fixef(himod.tsme)[7],fixef(himod.tsme)[7]+fixef(himod.tsme)[12:15])
tsmehican.se=c(summary(himod.tsme)$coef[6,2],summary(himod.tsme)$coef[8:11,2])
tsmehiund.se=c(summary(himod.tsme)$coef[7,2],summary(himod.tsme)$coef[12:15,2])
abamhican=c(fixef(himod.abam)[6],fixef(himod.abam)[6]+fixef(himod.abam)[8:11])
abamhiund=c(fixef(himod.abam)[7],fixef(himod.abam)[7]+fixef(himod.abam)[12:15])
abamhican.se=c(summary(himod.abam)$coef[6,2],summary(himod.abam)$coef[8:11,2])
abamhiund.se=c(summary(himod.abam)$coef[7,2],summary(himod.abam)$coef[12:15,2])
tshehican=c(fixef(himod.tshe)[4],fixef(himod.tshe)[4]+fixef(himod.tshe)[6:7])
tshehiund=c(fixef(himod.tshe)[5],fixef(himod.tshe)[5]+fixef(himod.tshe)[8:9])
tshehican.se=c(summary(himod.tshe)$coef[4,2],summary(himod.tshe)$coef[6:7,2])
tshehiund.se=c(summary(himod.tshe)$coef[4,2],summary(himod.tshe)$coef[8:9,2])
###Barplot
quartz(height=7,width=7)
par(mfcol=c(3,2),mai=c(.6,.8,.2,.1), omi=c(.7,.01,.2,.2))
plottsme<-barplot(as.matrix(rbind(tsmesurvund,tsmesurvcan)),width=.9,ylab="",xlab="",names.arg=c("","","","",""),ylim=c(-1,1),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3,xaxt='n', yaxt='n')
mtext("Tsuga mertensiana",side=3,line=1, adj=0, font=3)
m
tsmesurvund
fixef(himod.tshe
1)
fixef(himod.tshe)
compsurvmod.tsme=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=tsmedat)
summary(compsurvmod.tsme)#LL: -2813.5 (Null LL:-2864.7)
coef(compsurvmod.tsme)[6]
tsmesurvcan=c(coef(compsurvmod.tsme)[6],coef(compsurvmod.tsme)[6]+coef(compsurvmod.tsme)[8:11])
tsmesurvcan
tsmesurvund
quartz(height=7,width=7)
par(mfcol=c(3,2),mai=c(.6,.8,.2,.1), omi=c(.7,.01,.2,.2))
plottsme<-barplot(as.matrix(rbind(tsmesurvund,tsmesurvcan)),width=.9,ylab="",xlab="",names.arg=c("","","","",""),ylim=c(-1,1),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3,xaxt='n', yaxt='n')
mtext("Tsuga mertensiana",side=3,line=1, adj=0, font=3)
mtext("a",side=3,line=1, adj=-.1)
polygon(c(3.5,3.5,11,11),c(-1,1,1,-1),col="light gray", border="light gray")
par(new=T)
plottsme<-barplot(as.matrix(rbind(tsmesurvund,tsmesurvcan)),width=.9,ylab="",xlab="",names.arg=c("","","","",""),ylim=c(-1,1),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
abline(h=0)
x<-c(plottsme)
alltsme.lcl=rbind(tsmesurvund-tsmesurvund.se,tsmesurvcan-tsmesurvcan.se)
alltsme.ucl=rbind(tsmesurvund+tsmesurvund.se,tsmesurvcan+tsmesurvcan.se)
#add error bars
for (i in 1:length(alltsme.lcl)){
arrows(x[i],alltsme.lcl[i],x[i],alltsme.ucl[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "(1064)", "(1197)","(1460)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
##ABAM
plotabam<-barplot(as.matrix(rbind(abamsurvund,abamsurvcan)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.5,1.5),las=1,col=c("palegreen1","darkgreen"),xaxt='n', yaxt='n',beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
polygon(c(3.5,3.5,11,11),c(-1.5,1.5,1.5,-1.5),col="light gray", border="light gray")
par(new=T)
plotabam<-barplot(as.matrix(rbind(abamsurvund,abamsurvcan)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.5,1.5),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
mtext("Abies amabilis",side=3,line=1, adj=0, font=3)
mtext("b",side=3,line=1, adj=-.1)
abline(h=0)
mtext("Effect of neighbors on survival time", side=2, line=4.3)
mtext("(Proportion, relative to no neighbors)", side=2, line=3, cex=.9)
x<-c(plotabam)
allabam.lcl=rbind(abamsurvund-abamsurvund.se,abamsurvcan-abamsurvcan.se)
allabam.ucl=rbind(abamsurvund+abamsurvund.se,abamsurvcan+abamsurvcan.se)
#add error bars
for (i in 1:length(allabam.lcl)){
arrows(x[i],allabam.lcl[i],x[i],allabam.ucl[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "(668)", "(704)","(1064)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
##TSHE
tshesurvund2=c(NA,NA,tshesurvund)
tshesurvcan2=c(NA,NA,tshesurvcan)
plottshe<-barplot(as.matrix(rbind(tshesurvund2,tshesurvcan2)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),xaxt='n', yaxt='n',ylim=c(-1.5,.5),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
polygon(c(3.5,3.5,11,11),c(-1.5,.5,.5,-1.5),col="light gray", border="light gray")
mtext("Tsuga heterophylla",side=3,line=1, adj=0, font=3)
mtext("c",side=3,line=1, adj=-.1)
abline(h=0)
par(new=T)
plottshe<-barplot(as.matrix(rbind(tshesurvund2,tshesurvcan2)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.5,.5),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
abline(h=0)
x<-c(plottshe)
tshesurvund.se2=c(0,0,tshesurvund.se)
tshesurvcan.se2=c(0,0,tshesurvcan.se)
alltshe.lcl2=rbind(tshesurvund2-tshesurvund.se2,tshesurvcan2-tshesurvcan.se2)
alltshe.ucl2=rbind(tshesurvund2+tshesurvund.se2,tshesurvcan2+tshesurvcan.se2)
#add error bars
for (i in 1:length(alltshe.lcl2)){
arrows(x[i],alltshe.lcl2[i],x[i],alltshe.ucl2[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "", "","(668)", "(704)","(1064)"), tick = FALSE, cex.axis=1.1, line=-.5)
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "Below","Lower","Mid", "Upper", "Above"), tick = FALSE, cex.axis=1.1, line=0.5)
mtext("Location in range (m)",line=-13.5, adj=.6)
#Now ANNUAL HI
plottsme<-barplot(as.matrix(rbind(tsmehiund,tsmehican)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1,1),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3,xaxt='n', yaxt='n')
mtext("Tsuga mertensiana",side=3,line=1, adj=0, font=3)
mtext("d",side=3,line=1, adj=-.1)
polygon(c(3.5,3.5,11,11),c(-1,1,1,-1),col="light gray", border="light gray")
par(new=T)
plottsme<-barplot(as.matrix(rbind(tsmehiund,tsmehican)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1,1),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
abline(h=0)
x<-c(plottsme)
allhitsme.lcl=rbind(tsmehiund-tsmehiund.se,tsmehican-tsmehican.se)
allhitsme.ucl=rbind(tsmehiund+tsmehiund.se,tsmehican+tsmehican.se)
#add error bars
for (i in 1:length(allhitsme.lcl)){
arrows(x[i],allhitsme.lcl[i],x[i],allhitsme.ucl[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "(1064)", "(1197)","(1460)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
##ABAM
plotabam<-barplot(as.matrix(rbind(abamhiund,abamhican)),ylab="",xlab="",names.arg=c("","","","",""),width=.9,ylim=c(-1.2,1),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3,xaxt='n', yaxt='n')
polygon(c(3.5,3.5,11,11),c(-1.2,1,1,-1.2),col="light gray", border="light gray")
par(new=T)
plotabam<-barplot(as.matrix(rbind(abamhiund,abamhican)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.2,1),las=1,col=c("palegreen1","darkgreen"),,beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
abline(h=0)
x<-c(plotabam)
allhiabam.lcl=rbind(abamhiund-abamhiund.se,abamhican-abamhican.se)
allhiabam.ucl=rbind(abamhiund+abamhiund.se,abamhican+abamhican.se)
668,704,1064,1197,1460,1605,1676
#add error bars
for (i in 1:length(allhiabam.lcl)){
arrows(x[i],allhiabam.lcl[i],x[i],allhiabam.ucl[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "(668)","(704)","(1460)","(1605)","(1676)"), tick = FALSE, cex.axis=1.1, line=-.5)
mtext("Abies amabilis",side=3,line=1, adj=0, font=3)
mtext("e",side=3,line=1, adj=-.1)
mtext("Effect of neighbors on growth", side=2, line=4.3)
mtext("(Difference in annual increment, relative to no neighbors)", side=2, line=3, cex=.9)
##TSHE
tshehiund2=c(NA,NA,tshehiund)
tshehican2=c(NA,NA,tshehican)
plottshe<-barplot(as.matrix(rbind(tshehiund2,tshehican2)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),xaxt='n', yaxt='n',ylim=c(-1.7,.5),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
polygon(c(3.5,3.5,11,11),c(-1.7,.5,.5,-1.7),col="light gray", border="light gray")
mtext("Tsuga heterophylla",side=3,line=1, adj=0, font=3)
mtext("f",side=3,line=1, adj=-.1)
abline(h=0)
par(new=T)
plottshe<-barplot(as.matrix(rbind(tshehiund2,tshehican2)),ylab="",xlab="",width=.9,names.arg=c("","","","",""),ylim=c(-1.7,.5),las=1,col=c("palegreen1","darkgreen"),beside=TRUE,cex.names=1.3,cex.lab=1,cex.main=1.5,cex.axis=1.3)
abline(h=0)
x<-c(plottshe)
tshehiund.se2=c(0,0,tshehiund.se)
tshehican.se2=c(0,0,tshehican.se)
alltshe.lcl2=rbind(tshehiund2-tshehiund.se2,tshehican2-tshehican.se2)
alltshe.ucl2=rbind(tshehiund2+tshehiund.se2,tshehican2+tshehican.se2)
#add error bars
for (i in 1:length(alltshe.lcl2)){
arrows(x[i],alltshe.lcl2[i],x[i],alltshe.ucl2[i],length=.03,angle=90,code=0)}
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "", "","(668)", "(704)","(1064)"), tick = FALSE, cex.axis=1.1, line=-.5)
axis(1, at = c(1.8,4.5,7.2,9.9,12.5), labels = c( "Below","Lower","Mid", "Upper", "Above"), tick = FALSE, cex.axis=1.1, line=0.5)
mtext("Location in range (m)",line=-13.5, adj=.6)
summary(himod.tshe
)
compsurvmod.tsme=survreg(Surv(time1,time2, type="interval2")~-1+PlantedStand*Canopy*Understory, dist="lognormal", data=tsmedat)
summary(compsurvmod.tsme)#LL: -2813.5 (Null LL:-2864.7)
unique(tsmedat$Canopy)
head(tsmedat)
summary(compsurvmod.tsme)#LL: -2813.5 (Null LL:-2864.7)
compsurvmod.tsme=survreg(Surv(time1,time2, type="interval2")~-1+as.factor(PlantedStand)*as.factor(Canopy)*as.factor(Understory), dist="lognormal", data=tsmedat)
summary(compsurvmod.tsme)#LL: -2813.5 (Null LL:-2864.7)
himod.abam<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=abamdat)#
summary(himod.abam)
himod.tsme<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=tsmedat)
summary(himod.tsme)
himod.tshe<-lmer(annhi ~ -1+PlantedStand*Canopy*Understory+(1|Block),REML=FALSE, data=tshedat)#
summary(himod.tshe)
data<-read.csv("AllStands_clim1.csv", header=TRUE)
getwd()
data<-read.csv("data/AllStands_clim1.csv", header=TRUE)
data$Elevation_mfact<-as.factor(data$Elevation_m)
data$Elevation_m<-as.numeric(data$Elevation_m)
data$Block<-as.factor(data$Block)
head(data)
plot(data$snow_cover_duration~data$Elevation_m)
plot(data$GDD_total~data$Elevation_m)
plot(data$Light_Mean~data$Elevation_m)
plot(data$GDD_total~data$Elevation_m)
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.snow)#3 way interaction not significant, but understory is significant
summary(constmod.snow)
data$Elevation_m<-as.numeric(data$Elevation_m)
constmod.gdd<-lmer(GDD_total~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.gdd)#3 way interaction not significant, understory not significant
summary(constmod.gdd)
constmod.gdd_noint<-lmer(GDD_total~-1+Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
summary(constmod.gdd_noint)
badat=read.csv("MtRainierData_2.csv", header=T)
badat=read.csv("data/MtRainierData_2.csv", header=T)
Anova(constmod.tsme, test.statistic="LR", type="III")#
Anova(constmod.tshe,test.statistic="LR", type="III")#
Anova(constmod.abam, test.statistic="LR", type="III")#
hist(data$snow_cover_duration)
hist(data$GDD_total)
hist(data$Light_Mean)
hist(data$PAR)
head(data)
unique(data$GDDLightYear)
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
constmod.snow2<-lmer(snow_cover_duration~Elevation_m+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
constmod.snow2<-lmer(snow_cover_duration~Elevation_m+Canopy+Understory+Elevation_m:Canopy+Elevation_m:Understory+Canopy:Understory+Elevation_m:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
AICctab(constmod.snow,constmod.snow2)
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
summary(constmod.snow)
data$Elevation_mfact<-as.factor(data$Elevation_m)
unique(data$Elevation_mfact)
constmod.light<-lmer(Light_Mean~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
summary(constmod.snow)
constmod.gdd<-lmer(GDD_total~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.gdd)#3 way interaction not significant, understory not significant
summary(constmod.gdd)
constmod.light<-lmer(Light_Mean~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
Anova(constmod.gdd)#3 way interaction not significant, understory not significant
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),family="poisson",REML=FALSE,  data=data)
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),family="poisson", data=data)
constmod.snow<-glmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),family="poisson", data=data)
Anova(consmod.snow, type="III")
Anova(constmod.snow, type="III")
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),data=data)
constmod.snow.glm<-glmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),family="poisson", data=data)
Anova(constmod.snow.glm, type="III")#3 way interaction not significant, but understory is significant
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
summary(constmod.snow)
summary(constmod.snow.glm)
AICctab(constmod.snow,constmod.snow.glm)
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),data=data)
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
constmod.gdd<-lmer(GDD_total~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.gdd)#3 way interaction not significant, understory not significant
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),data=data)
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
constmod.gdd<-lmer(GDD_total~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.gdd, type="III")#3 way interaction not significant, understory not significant
constmod.gdd<-lmer(GDD_total~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.gdd, type="III")#3 way interaction not significant, understory not significant
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
anova(constmod.gdd, type="III")#3 way interaction not significant, understory not significant
summary(constmod.snow)
df(constmod.gdd)
constmod.snow<-lmer(snow_cover_duration~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,data=data)
Anova(constmod.snow, type="III")#3 way interaction not significant, but understory is significant
summary(constmod.snow)
constmod.light<-lmer(Light_Mean~Elevation_mfact+Canopy+Understory+Elevation_mfact:Canopy+Elevation_mfact:Understory+Canopy:Understory+Elevation_mfact:Canopy:Understory+(1|Block),REML=FALSE,  data=data)
Anova(constmod.light, type="III")#3 way interaction not significant, understory not significant
psiV = 0.98
psiR = 0.93
pdormV = 0.34
pdormR = 0.05
veg.rep = 0.45 # guess from your figure
rep.veg = 0.2 # guess from your figure
tmx.1 = c(psiV*(1-veg.rep)*pdormV, psiR*rep.veg*pdormV, psiV*(1-veg.rep)*pdormV, psiR*rep.veg*pdormV,
psiV*veg.rep*pdormR, psiR*(1-rep.veg)*pdormR, psiV*veg.rep*pdormR, psiR*(1-rep.veg)*pdormR,
psiV*(1-veg.rep)*(1-pdormV), psiR*rep.veg*(1-pdormV), psiV*(1-veg.rep)*(1-pdormV), psiR*rep.veg*(1-pdormV),
psiV*veg.rep*(1-pdormR), psiR*(1-rep.veg)*(1-pdormR), psiV*veg.rep*(1-pdormR), psiR*(1-rep.veg)*(1-pdormR))
tmx.1 = matrix(tmx.1, nrow = 4, byrow = T)
tmx.1
rowSums(tmx.1)
colSums(tmx.1)
